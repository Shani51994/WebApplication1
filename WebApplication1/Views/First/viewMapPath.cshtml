
@{
    ViewBag.Title = "viewMapPath";
}

<!DOCTYPE html>
<html>
<head>
    <style>
        html
        body {
            width: 100%;
            height: 100%;
            margin: 0;
        }

        canvas {
            display: block;
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
        }
    </style>
</head>
<body>
    <canvas id="canvas"></canvas>

    <script>
       
        var IntervalTime = @Session["time"] * 1000
 
        myTimer = (function () {
            $.post("@Url.Action("createXmlData")").done(function (xml) {
                alert(xml);

                var xmlDoc = $.parseXML(xml),
                    $xml = $(xmlDoc);
                    var Lon = $xml.find( "Lon" ).text();
                    var Lat = $xml.find("Lat").text();

                var htmlCanvas = document.getElementById("canvas");
                var context = htmlCanvas.getContext("2d");
                var image = new Image();

                initialize();

                function initialize() {
                    window.addEventListener('resize', resizeCanvas, false);
                }
                    htmlCanvas.width = window.innerWidth;
                    htmlCanvas.height = window.innerHeight;
                    image.onload = function () {
                        context.lineWidth = '5';
                        context.strokeStyle = "navy";
                        context.drawImage(image, 0, 0, window.innerWidth, window.innerHeight);
                        context.beginPath();
                        var lat = (Lat + 90) * (htmlCanvas.height / 180);
                        var lon = (Lon + 180) * (htmlCanvas.width / 360);
                        context.arc(lon, lat, 7, 0, 2 * Math.PI);
                        context.fillStyle = "red";
                        context.fill()
                        context.stroke();
                    }
                    image.src = "/export-map-share.png";
            });
         });

        setInterval(myTimer, IntervalTime);
        myTimer();

    </script>

</body>
</html>
